USE mi_empresa;

-- Seleccionar el nombre, el puesto y la localidad de los departamentos donde trabajan los vendedores.
SELECT CONCAT(empleado.nombre, " " , empleado.apellido) AS empleado, empleado.puesto, departamento.localidad
FROM empleado
INNER JOIN departamento
ON empleado.depto_nro = departamento.depto_nro;

-- Visualizar los departamentos con más de cinco empleados.
SELECT departamento.nombre_depto
FROM departamento
WHERE departamento.depto_nro in
(SELECT depto_nro
FROM empleado
GROUP BY depto_nro
HAVING COUNT(1) > 5);

-- Mostrar el nombre, salario y nombre del departamento de los empleados que tengan el mismo puesto que ‘Mito Barchuk’.
SELECT CONCAT(empleado.nombre, " " , empleado.apellido) AS empleado, empleado.salario, departamento.nombre_depto
FROM empleado
INNER JOIN departamento
ON empleado.depto_nro = departamento.depto_nro
WHERE empleado.puesto LIKE
(SELECT puesto FROM empleado
WHERE cod_emp = 'E-0006');

-- Mostrar los datos de los empleados que trabajan en el departamento de contabilidad, ordenados por nombre.

/* Id directo */
SELECT empleado.cod_emp, CONCAT(empleado.nombre, " " , empleado.apellido) AS empleado, empleado.puesto, empleado.fecha_alta, empleado.salario, empleado.comision, departamento.nombre_depto
FROM empleado
INNER JOIN departamento
ON empleado.depto_nro = departamento.depto_nro
WHERE empleado.depto_nro = 'D-000-3'
ORDER BY empleado ASC;

/* Busqueda de Id */
SELECT empleado.cod_emp, CONCAT(empleado.nombre, " " , empleado.apellido) AS empleado, empleado.puesto, empleado.fecha_alta, empleado.salario, empleado.comision, departamento.nombre_depto
FROM empleado
INNER JOIN departamento
ON empleado.depto_nro = departamento.depto_nro
WHERE empleado.depto_nro = 
(SELECT departamento.depto_nro 
FROM departamento
WHERE UPPER(departamento.nombre_depto) LIKE UPPER("%Contabilidad%"))
ORDER BY empleado ASC;

-- Mostrar el nombre del empleado que tiene el salario más bajo.
/* Aplico Subconsulta */
SELECT CONCAT(empleado.nombre, " " , empleado.apellido) AS empleado
FROM empleado
WHERE empleado.salario = 
(SELECT MIN(empleado.salario)
FROM empleado);

/* Aplico Limit */
SELECT CONCAT(empleado.nombre, " " , empleado.apellido) AS empleado
FROM empleado
ORDER BY empleado.salario ASC
LIMIT 1;

-- Mostrar los datos del empleado que tiene el salario más alto en el departamento de ‘Ventas’.
/* Aplico Subconsulta */
SELECT empleado.cod_emp, CONCAT(empleado.nombre, " " , empleado.apellido) AS empleado, empleado.puesto, empleado.fecha_alta, empleado.salario, empleado.comision
FROM empleado
WHERE empleado.salario = 
(SELECT MAX(empleado.salario)
FROM empleado
INNER JOIN departamento
ON empleado.depto_nro = departamento.depto_nro
WHERE departamento.depto_nro = 'D-000-4');

/* Aplico Limit */
SELECT empleado.cod_emp, CONCAT(empleado.nombre, " " , empleado.apellido) AS empleado, empleado.puesto, empleado.fecha_alta, empleado.salario, empleado.comision
FROM empleado
WHERE empleado.depto_nro = 'D-000-4'
ORDER BY empleado.salario DESC
LIMIT 1;
